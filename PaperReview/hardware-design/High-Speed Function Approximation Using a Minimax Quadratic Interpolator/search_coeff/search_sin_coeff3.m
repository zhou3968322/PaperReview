% this script is to compute sin pi / 4 x. without variant multiplication correction.
f = @(x) sin(pi * x/4);
m = 5;
table_size = 2^m;

error_approx = 2^(-22);

t_range = [27, 26, 25, 24, 23, 22];

% p * 2^{-m}, p error is more than 18 bit.
p_range = [19, 18, 17, 16, 15];

% q * 2^{-2m}, q error is less than 12 bit.
q_range = [14, 13, 12, 11];

max_table_bits = 0;

results = struct('t', {}, 'p', {}, 'q', {}, 'coeff_size', {}, 'max_error', {});


for p = p_range
    for t = t_range
        for q = q_range
            [approx, int_approx, normr, max_error, success] = computecoeffs1(f, t, p, q, table_size, error_approx);
            if success
                coeff_size = p + t + q;
                results(end+1) = struct('t', t, 'p', p, 'q', q, 'coeff_size', coeff_size, 'max_error', max_error);
            end
        end
    end
end 

resultsTable = struct2table(results);
resultsTable = sortrows(resultsTable, 'p');
resultsTable = sortrows(resultsTable, 'coeff_size');

% Display or process the sorted results
disp(resultsTable);


    t     p     q     coeff_size    max_error 
    % __    __    __    __________    __________
    % 
    % 23    15    11        49        1.9772e-07
    % 24    15    11        50        1.9754e-07
    % 23    15    12        50         1.983e-07
    % 23    16    11        50        1.8783e-07
    % 22    17    11        50        2.3016e-07
    % 25    15    11        51        1.9754e-07
    % 24    15    12        51         1.983e-07
    % 23    15    13        51        1.9338e-07
    % 24    16    11        51        1.8783e-07
    % 23    16    12        51        1.7177e-07
    % 22    16    13        51        2.2488e-07
    % 23    17    11        51        2.0199e-07
    % 22    17    12        51        2.3016e-07
    % 22    18    11        51          2.35e-07
    % 26    15    11        52        1.9754e-07
    % 25    15    12        52         1.983e-07
    % 24    15    13        52        1.8298e-07
    % 23    15    14        52        2.0365e-07
    % 25    16    11        52        1.5803e-07
    % 24    16    12        52        1.8596e-07
    % 23    16    13        52        1.6482e-07
    % 22    16    14        52        2.1045e-07
    % 24    17    11        52        2.0199e-07
    % 23    17    12        52        1.6272e-07
    % 22    17    13        52        2.0628e-07
    % 23    18    11        52          2.35e-07
    % 22    18    12        52        2.0698e-07
    % 22    19    11        52          2.35e-07
    % 27    15    11        53          2.05e-07
    % 26    15    12        53         1.834e-07
    % 25    15    13        53        1.6603e-07
    % 24    15    14        53        1.8298e-07
    % 26    16    11        53        1.7106e-07
    % 25    16    12        53        1.5616e-07
    % 24    16    13        53        1.6065e-07
    % 23    16    14        53        1.6491e-07
    % 25    17    11        53        1.8077e-07
    % 24    17    12        53        1.7055e-07
    % 23    17    13        53        1.4544e-07
    % 22    17    14        53        2.0628e-07
    % 24    18    11        53        2.0315e-07
    % 23    18    12        53        1.7641e-07
    % 22    18    13        53        1.9661e-07
    % 23    19    11        53          2.35e-07
    % 22    19    12        53        2.1056e-07
    % 27    15    12        54         1.834e-07
    % 26    15    13        54        1.6808e-07
    % 25    15    14        54        1.7385e-07
    % 27    16    11        54        1.7106e-07
    % 26    16    12        54        1.7106e-07
    % 25    16    13        54        1.3203e-07
    % 24    16    14        54        1.3611e-07
    % 26    17    11        54        1.8709e-07
    % 25    17    12        54        1.4075e-07
    % 24    17    13        54        1.2435e-07
    % 23    17    14        54        1.4544e-07
    % 25    18    11        54        1.7539e-07
    % 24    18    12        54         1.543e-07
    % 23    18    13        54        1.4206e-07
    % 22    18    14        54        1.8992e-07
    % 24    19    11        54        1.9707e-07
    % 23    19    12        54        1.7641e-07
    % 22    19    13        54        2.2272e-07
    % 27    15    13        55        1.6421e-07
    % 26    15    14        55        1.6808e-07
    % 27    16    12        55        1.7106e-07
    % 26    16    13        55        1.3308e-07
    % 25    16    14        55        1.3203e-07
    % 27    17    11        55        1.8709e-07
    % 26    17    12        55        1.4075e-07
    % 25    17    13        55        1.1564e-07
    % 24    17    14        55        1.2435e-07
    % 26    18    11        55        1.8217e-07
    % 25    18    12        55        1.4738e-07
    % 24    18    13        55        1.2534e-07
    % 23    18    14        55        1.4206e-07
    % 25    19    11        55        1.7539e-07
    % 24    19    12        55         1.543e-07
    % 23    19    13        55        1.3052e-07
    % 22    19    14        55         1.837e-07
    % 27    15    14        56        1.6421e-07
    % 27    16    13        56         1.383e-07
    % 26    16    14        56        1.2121e-07
    % 27    17    12        56        1.4075e-07
    % 26    17    13        56        1.0197e-07
    % 25    17    14        56        1.1564e-07
    % 27    18    11        56        1.8284e-07
    % 26    18    12        56        1.3248e-07
    % 25    18    13        56         1.072e-07
    % 24    18    14        56        1.2435e-07
    % 26    19    11        56        1.8217e-07
    % 25    19    12        56        1.4738e-07
    % 24    19    13        56        1.1348e-07
    % 23    19    14        56        1.3109e-07
    % 27    16    14        57        1.1973e-07
    % 27    17    13        57        1.0672e-07
    % 26    17    14        57        1.0197e-07
    % 27    18    12        57        1.3248e-07
    % 26    18    13        57        1.1044e-07
    % 25    18    14        57        9.9472e-08
    % 27    19    11        57        1.8284e-07
    % 26    19    12        57        1.3248e-07
    % 25    19    13        57        1.0351e-07
    % 24    19    14        57        1.1348e-07
    % 27    17    14        58        1.0672e-07
    % 27    18    13        58        1.0299e-07
    % 26    18    14        58        9.8575e-08
    % 27    19    12        58        1.3248e-07
    % 26    19    13        58        1.1155e-07
    % 25    19    14        58         9.781e-08
    % 27    18    14        59        9.4548e-08
    % 27    19    13        59        1.1155e-07
    % 26    19    14        59        9.8575e-08
    % 27    19    14        60        9.1124e-08